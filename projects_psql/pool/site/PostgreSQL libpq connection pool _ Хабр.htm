<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
  <meta name="referrer" content="unsafe-url">
  <title>PostgreSQL libpq connection pool / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0da14ebf.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.f2cd882e.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.04c2974e.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.4441b282.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0da14ebf.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.04c2974e.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.9143e7f16464deb606c9d6b057cbd3e9.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/articles\/322966\/"},"headline":"PostgreSQL libpq connection pool","datePublished":"2017-03-01T13:30:05+03:00","dateModified":"2017-03-02T10:12:28+03:00","author":{"@type":"Person","name":"Sergey Borisov"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компа...","url":"https:\/\/habr.com\/ru\/articles\/322966\/#post-content-body","about":["h_postgresql","h_cpp","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/322966\/caae7f785891764fe20e5cf747bc4dfd\/"]}</script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.144.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="PostgreSQL libpq connection pool" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="PostgreSQL libpq connection pool" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="PostgreSQL libpq connection pool" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании PostgresPRO . При написании..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании PostgresPRO . При написании..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании PostgresPRO . При написании..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании PostgresPRO . При написании..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании PostgresPRO . При написании..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/322966/caae7f785891764fe20e5cf747bc4dfd/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/322966/caae7f785891764fe20e5cf747bc4dfd/" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/322966/caae7f785891764fe20e5cf747bc4dfd/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/322966/caae7f785891764fe20e5cf747bc4dfd/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/322966/caae7f785891764fe20e5cf747bc4dfd/?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="322966" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2017-03-01T10:30:05.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/articles/322966/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="C++, postgresql">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/publications/322966/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/articles/322966/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" rel="image_src" href="https://habr.com/share/publication/322966/caae7f785891764fe20e5cf747bc4dfd/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
  <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script>
  <script>window.yaContextCb = window.yaContextCb || []</script>
  <script src="https://yandex.ru/ads/system/context.js" async></script>
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/articles/" class="tm-main-menu__item tm-main-menu__item_active">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark"><title>Профиль</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><!----> <div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__icon pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/sborisov/" title="sborisov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/088.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/sborisov/" class="tm-user-info__username">
      sborisov
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2017-03-01T10:30:05.000Z" title="2017-03-01, 13:30">1  мар  2017 в 13:30</time></span></span></span></div> <!----></div> <h1 lang="ru" class="tm-title tm-title_h1"><span>PostgreSQL libpq connection pool</span></h1> <div class="tm-article-snippet__stats"><!----> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    5 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">39K</span></span></div> <div class="tm-publication-hubs__container"><div class="tm-publication-hubs"><span class="tm-publication-hub__link-container"><a href="/ru/hubs/postgresql/" class="tm-publication-hub__link"><span>PostgreSQL</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/cpp/" class="tm-publication-hub__link"><span>C++</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div></div> <div class="tm-article-snippet__labels-container"><div class="tm-article-snippet__labels"><div class="tm-publication-label tm-publication-label_variant-tutorial"><span>
    Туториал
  </span></div> </div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании <a href="https://postgrespro.ru/docs/postgresql/9.6/libpq">PostgresPRO</a>.<br/>
<br/>
При написании серверного бекэнда, столкнулся с тем, что в этой библиотеке нет никакого пула коннектов, а работа с БД, предполагалась в довольно интенсивном режиме и одного коннекта было явно мало. Каждый раз устанавливать соединение для отправки полученных данных, было бы просто безумием, т.к. соединение самая долгая операция, решено было написать свой пул коннектов. <br/>
<a name="habracut"></a><br/>
Идея в том, что мы при старте программы создаём несколько соединений и храним их в очереди. <br/>
<br/>
Когда приходят данные, мы просто берём свободное соединеие из очереди, а если свободных соединений нет — ждём когда появится, используем его для вставки данных, а затем помещаем соединение обратно. Идея довольна простая, быстро реализуема и самое главное, скорость работы очень высокая. <br/>
<br/>
Создадим в PostgreSQL базу с именем demo, табличкой demo такой <br/>
<br/>
<div class="spoiler"><b class="spoiler_title">структуры</b><div class="spoiler_text"><pre><code class="sql">-- Table: public.demo

-- DROP TABLE public.demo;

CREATE TABLE public.demo
(
  id integer NOT NULL DEFAULT nextval('demo_id_seq'::regclass),
  name character varying(256),
  CONSTRAINT demo_pk PRIMARY KEY (id)
)
WITH (
  OIDS=FALSE
);
ALTER TABLE public.demo
  OWNER TO postgres;
</code></pre><br/>
</div></div><br/>
Пишем класс который будет представлять собой соединение к БД, параметры соединения, будут прописаны прямо в коде для его упрощения, в реальности конечно их надо хранить в конфигурационном файле и при запуске считывать оттуда, чтобы при изменении парметров сервера, не приходилось перекомпилировать программу. <br/>
<br/>
<div class="spoiler"><b class="spoiler_title">pgconnection.h</b><div class="spoiler_text"><pre><code class="cpp">#ifndef PGCONNECTION_H
#define PGCONNECTION_H

#include &lt;memory>
#include &lt;mutex>
#include &lt;libpq-fe.h>

class PGConnection
{
public:
    PGConnection();
    std::shared_ptr&lt;PGconn> connection() const;

private:
    void establish_connection();

    std::string m_dbhost = "localhost";
    int         m_dbport = 5432;
    std::string m_dbname = "demo";
    std::string m_dbuser = "postgres";
    std::string m_dbpass = "postgres";

    std::shared_ptr&lt;PGconn>  m_connection;

};


#endif //PGCONNECTION_H</code></pre></div></div><br/>
<div class="spoiler"><b class="spoiler_title">pgconnection.cpp</b><div class="spoiler_text"><pre><code class="cpp">#include "pgconnection.h"
PGConnection::PGConnection()
{
    m_connection.reset( PQsetdbLogin(m_dbhost.c_str(), std::to_string(m_dbport).c_str(), nullptr, nullptr, m_dbname.c_str(), m_dbuser.c_str(), m_dbpass.c_str()), &amp;PQfinish );

    if (PQstatus( m_connection.get() ) != CONNECTION_OK &amp;&amp; PQsetnonblocking(m_connection.get(), 1) != 0 )
    {
       throw std::runtime_error( PQerrorMessage( m_connection.get() ) );
    }

}


std::shared_ptr&lt;PGconn> PGConnection::connection() const
{
    return m_connection;
}
</code></pre><br/>
</div></div><br/>
Чтобы предотвратить возможную утечку ресурсов, соединиение мы будем хранить в умном указателе.<br/>
<br/>
В конструкторе мы вызывам функцию PQsetdbLogin, которая устанавливает соединение к БД, возвращая указатель на соедининие PGconn* и переводим соедининие в асинхронный режим работы.<br/>
<br/>
При завершении работы, соединие должно быть удалено функцией PQfinish, которой передается указатель, возвращённый функцией PQsetdbLogin. Поэтому последним параметром в вызове m_connection.reset() мы передаём адрес функции &amp;PQfinish. Когда умный указатель выйдет из области видимости и счётчик ссылок обнулиться, он вызовет эту функцию, тем самым корректно завершив соединие. <br/>
<br/>
Теперь нам нужен класс, который будет создавать, хранить и управлять работой пула коннектов.<br/>
<br/>
<div class="spoiler"><b class="spoiler_title">pgbackend.h</b><div class="spoiler_text"><pre><code class="cpp">
#ifndef PGBACKEND_H
#define PGBACKEND_H

#include &lt;memory>
#include &lt;mutex>
#include &lt;string>
#include &lt;queue>
#include &lt;condition_variable>
#include &lt;libpq-fe.h>
#include "pgconnection.h"


class PGBackend
{
public:
    PGBackend();
    std::shared_ptr&lt;PGConnection> connection();
    void freeConnection(std::shared_ptr&lt;PGConnection>);

private:
    void createPool();
    
    std::mutex m_mutex;
    std::condition_variable m_condition;
    std::queue&lt;std::shared_ptr&lt;PGConnection>> m_pool;

    const int POOL = 10;


};

#endif //PGBACKEND_H</code></pre><br/>
</div></div><br/>
<div class="spoiler"><b class="spoiler_title">pgbackend.cpp</b><div class="spoiler_text"><pre><code class="cpp">
#include &lt;iostream>
#include &lt;thread>
#include &lt;fstream>
#include &lt;sstream>
#include "pgbackend.h"

PGBackend::PGBackend()
{

    createPool();
  
}

void PGBackend::createPool()
{
    std::lock_guard&lt;std::mutex> locker_( m_mutex );

    for ( auto i = 0; i&lt; POOL; ++i ){
         m_pool.emplace ( std::make_shared&lt;PGConnection>() );
    }
}

std::shared_ptr&lt;PGConnection> PGBackend::connection()
{

    std::unique_lock&lt;std::mutex> lock_( m_mutex );

    while ( m_pool.empty() ){
            m_condition.wait( lock_ );
    }

    auto conn_ = m_pool.front();
    m_pool.pop();

    return  conn_;
}


void PGBackend::freeConnection(std::shared_ptr&lt;PGConnection> conn_)
{
    std::unique_lock&lt;std::mutex> lock_( m_mutex );
    m_pool.push( conn_ );
    lock_.unlock();
    m_condition.notify_one();
}
</code></pre><br/>
</div></div><br/>
В функции createPool создаём пул соедининий, я установил 10 соединений. Далее — создаём класс PGBackend, и работаем с ним через функции connection — котороя возвращает свободное соединение к БД, и freeConnection — которая помещяет соединие обратно в очередь. <br/>
<br/>
Всё это работает на основе условных переменных, если очередь пуста, значит свободных соединений нет, и поток засыпает, пока не будет разбужен через условную переменную.<br/>
<br/>
Простейший пример, в котором используется наш бекэнд с пулом коннектов, приведён в файле main.cpp. В «боевых условия» у вас конечно будет какой-то цикл событий, при наступлении которых будет проводиться работа с БД. У меня это boost::asio, которая работает асинхронно и принимая события из сети, пишет всё в БД. Приводить здесь её излишне, чтобы не усложнять идею с пулом коннектов. Здесь мы просто создаём 50 потоков, которые работают с сервером через один экземляр PGBackend.<br/>
<br/>
<div class="spoiler"><b class="spoiler_title">main.cpp</b><div class="spoiler_text"><pre><code class="cpp">
#include &lt;thread>
#include &lt;iostream>
#include "pgbackend.h"

void testConnection(std::shared_ptr&lt;PGBackend> pgbackend)
{
//получаем свободное соединение
    auto conn = pgbackend->connection();

    std::string demo = "SELECT max(id) FROM demo; " ;
    PQsendQuery( conn->connection().get(), demo.c_str() );

    while ( auto res_ = PQgetResult( conn->connection().get()) ) {
        if (PQresultStatus(res_) == PGRES_TUPLES_OK &amp;&amp; PQntuples(res_)) {
            auto ID = PQgetvalue (res_ ,0, 0);
            std::cout&lt;&lt; ID&lt;&lt;std::endl;
        }

        if (PQresultStatus(res_) == PGRES_FATAL_ERROR){
            std::cout&lt;&lt; PQresultErrorMessage(res_)&lt;&lt;std::endl;
        }

        PQclear( res_ );
    }

//возвращаем соединение в очередь
    pgbackend->freeConnection(conn);

}


int main(int argc, char const *argv[])
{
	
	auto pgbackend = std::make_shared&lt;PGBackend>();

    
    std::vector&lt;std::shared_ptr&lt;std::thread>> vec;

    for ( size_t i = 0; i&lt; 50 ; ++i ){

        vec.push_back(std::make_shared&lt;std::thread>(std::thread(testConnection, pgbackend)));
    }

    for(auto &amp;i : vec) {
        i.get()->join();
    }

 
    return 0;
}

</code></pre><br/>
</div></div><br/>
Компилируется это всё командой:<br/>
<br/>
<pre><code class="bash">g++ main.cpp pgbackend.cpp pgconnection.cpp -o pool -std=c++14 -I/usr/include/postgresql/ -lpq -lpthread</code></pre><br/>
Будьте внимательны с количеством соединений БД — этот параметр задаётся параметром <a href="https://postgrespro.ru/docs/postgrespro/9.6/runtime-config-connection">max_connections (integer)</a>.<br/>
<br/>
<a href="https://github.com/borisovs/pool">Исходный код</a></div></div></div> <!----> <!----></div> <!----> <!----></div> <!----> <div class="tm-article-presenter__meta"><div class="tm-article-presenter__meta-list tm-separated-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BC%2B%2B%5D" class="tm-tags-list__link">C++</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpostgresql%5D" class="tm-tags-list__link">postgresql</a></li> <!----></ul></div> <div class="tm-article-presenter__meta-list tm-separated-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hubs/postgresql/" class="tm-hubs-list__link">PostgreSQL</a></li><li class="tm-separated-list__item"><a href="/ru/hubs/cpp/" class="tm-hubs-list__link">C++</a></li> <!----></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 26: ↑25 и ↓1</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Всего голосов 26: ↑25 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+24</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    56
  </span></button> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/articles/322966/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      20
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></div></div>  <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <div></div> <section class="tm-block tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/sborisov/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt src="https://assets.habr.com/habr-web/img/avatars/088.png" class="tm-entity-image__pic"></img></div></a> <div class="tm-user-card__meta"><div title=" 56 голосов " class="tm-counter-container tm-karma tm-karma"><div class="tm-counter-container__header"><div class="tm-karma__votes tm-karma__votes_negative">
      -18
    </div></div> <div class="tm-counter-container__footer"><div class="tm-karma__text">
      Карма
    </div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <div title="Рейтинг пользователя" class="tm-counter-container"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
        0
      </span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name tm-user-card__name_variant-article">Sergey Borisov</span> <a href="/ru/users/sborisov/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article">
          @sborisov
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-adfox-banner__container tm-page-article__banner"><!----> <div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-leaderboard"></div></div> <div class="tm-article-blocks__comments"><div id="publication-comments" class="tm-article-page-comments"><div data-async-called="true" class="tm-article-comments"><div class="tm-comments-wrapper"><div class="tm-comments-wrapper__wrapper"><header class="tm-comments-wrapper__header"><h2 class="tm-comments-wrapper__title">
        Комментарии
        <span class="tm-comments-wrapper__comments-count">
          20
        </span></h2> <div class="tm-comments-wrapper__header-aside"><!----> <button class="tm-rss-button tm-rss-button_comments-header"><span class="tm-svg-icon__wrapper tm-rss-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Скопировать ссылку на RSS</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#rss"></use></svg></span></button> <!----></div></header> <div class="tm-comments-wrapper__inner"> <!----> <div data-comments-list="" class="tm-comments__tree"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096438" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096438" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Tantrido/" title="Tantrido" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/04a/e83/a13/04ae83a134aa3d47ee970366e68f2859.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Tantrido/" class="tm-user-info__username">
      Tantrido
      <!----></a> <a href="#comment_10096438" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T15:35:00.000Z" title="2017-03-01, 18:35">1  мар  2017 в 18:35</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Почему не pqxx: для С++ логичнее было бы его использовать? На STL думаю проще было бы pool организовать:<br/>
http://stackoverflow.com/questions/12528199/libpqxx-connection-pool<br/>
<br/>
Он вроде даже когда-то был в этой библиотеке:<br/>
http://bazaar.launchpad.net/~jtv/libpqxx/connection-pool/view/head:/src/connection_pool.cxx<br/>
<br/>
<blockquote><b>Can I have two or more simultaneous transactions?</b><br/>
<br/>
<i>Not within the same connection. Even if you use nested transactions (see the subtransaction class), a connection is always dealing with just one transaction at a time. Of course you can create a new transaction on the same connection once the previous one has completed.<br/>
<br/>
If you want to have multiple concurrent transactions, let them work on different connections. An easy way to do this is to set up a connection pool: create a bunch of lazyconnection objects, all initialized with the same connection string. Connections of this type will set themselves up only when they are actually used, so there is no big cost to creating more than you're going to use. </i></blockquote>http://pqxx.org/development/libpqxx/wiki/FaqFeatures</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096438" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096732" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096732" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/sborisov/" title="sborisov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/088.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/sborisov/" class="tm-user-info__username">
      sborisov
      <!----></a> <a href="#comment_10096732" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T18:33:54.000Z" title="2017-03-01, 21:33">1  мар  2017 в 21:33</time> <svg height="16" width="16" class="tm-svg-img tm-comment-thread__icon-pencil"><title>Комментарий был изменен</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#pencil-small"></use></svg></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Она отстаёт по возможностям. Мне нужен был 9.5 c <a href="https://wiki.postgresql.org/wiki/What's_new_in_PostgreSQL_9.5#INSERT_..._ON_CONFLICT_DO_NOTHING.2FUPDATE_.28.22UPSERT.22.29">UPSERT</a>, и на тот момент libpqxx не имел этой возможности.<br/>
Документация была гораздо хуже. С libpq работать одно удовольствие, там весьма простой Си с очень хорошими примерами.<br/>
<br/>
<blockquote>На STL думаю проще было бы pool организовать</blockquote><br/>
 А я его на чём реализовал? Что здесь не из STL?<br/>
<pre><code class="cpp">std::mutex m_mutex;
std::condition_variable m_condition;
std::queue&lt;std::shared_ptr&lt;PGConnection>> m_pool;

</code></pre><br/>
</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096732" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096970" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096970" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Tantrido/" title="Tantrido" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/04a/e83/a13/04ae83a134aa3d47ee970366e68f2859.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Tantrido/" class="tm-user-info__username">
      Tantrido
      <!----></a> <a href="#comment_10096970" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T20:36:43.000Z" title="2017-03-01, 23:36">1  мар  2017 в 23:36</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Простите, недоглядел. Глянул, что С и не увидел дальше. Хорошая у вас реализация и простая. Надо будет себе утянуть. Я бы только добавил ещё map&lt;string, queue>, для группировки пулов по строкам подключения, если полноценный пул делать, когда не знаешь будут ли строки одинаковыми. А для REST-сервиса, при нехватке соединений m_pool.empty() создавал бы новое подключение.<br/>
<br/>
<blockquote>Мне нужен был 9.5 c UPSERT, и на тот момент libpqxx не имел этой возможности.</blockquote>А сейчас он там разве есть?<br/>
<br/>
Мне pqxx когда-то понравился, что он С++ и работал просто реактивно, по примерам разобрался как работает. Опять же lazy_connection.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096970" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096718" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096718" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/tankistua/" title="tankistua" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/181.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/tankistua/" class="tm-user-info__username">
      tankistua
      <!----></a> <a href="#comment_10096718" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T18:26:10.000Z" title="2017-03-01, 21:26">1  мар  2017 в 21:26</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml"><p>Чем pgbouncer или pgpool не подошел?</p></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096718" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096850" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096850" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Envek/" title="Envek" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/cf9/7ff/df8/cf97ffdf8a1a39e8d0d66fa14dc6d0d8.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Envek/" class="tm-user-info__username">
      Envek
      <!----></a> <a href="#comment_10096850" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T19:27:00.000Z" title="2017-03-01, 22:27">1  мар  2017 в 22:27</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml"><p>Мне казалось, что pgpool и иже — это штуки, ставящиеся возле сервера БД (между сервером и многими клиентами) и не решающие проблем, решаемых в статье (дорогое установление соединения от клиента к удалённому серверу).</p><br/>
<p>В общем, мне кажется, лучше всегда иметь собственный пул соединений в приложении.</p></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096850" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096868" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096868" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/tankistua/" title="tankistua" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/181.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/tankistua/" class="tm-user-info__username">
      tankistua
      <!----></a> <a href="#comment_10096868" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T19:34:44.000Z" title="2017-03-01, 22:34">1  мар  2017 в 22:34</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Да, лучше — но Вы не можете учесть все ситуации и Вам придется потратить время на разработку и отладку модуля объединения сессий.<br/>
<br/>
Сразу говорю я не программер, админ<br/>
<br/>
На первый взгляд:<br/>
 — надо объединять в пул не все сессии, а какое-то количество, по превышении порога открывать второй коннекшин<br/>
 — надо иметь механизм мониторинга коннектов, нужна какая-то статистика подключений<br/>
 — надо выставлять лимит в количество подключений — обязательно, иначе постгрес можно легко уложить какой-нибудь один лок<br/>
<br/>
Это все есть в пгбаунсере и еще много чего другого</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096868" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096978" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-3"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096978" class="tm-comment-thread__indent_l-3"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Tantrido/" title="Tantrido" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/04a/e83/a13/04ae83a134aa3d47ee970366e68f2859.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Tantrido/" class="tm-user-info__username">
      Tantrido
      <!----></a> <a href="#comment_10096978" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T20:45:21.000Z" title="2017-03-01, 23:45">1  мар  2017 в 23:45</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">В C# npgsql всё это есть, жаль, что реализации для С++ нет, в pqxx, например, надо самому делать. Был вариант для версии 2009 года.<br/>
<br/>
<blockquote>— надо объединять в пул не все сессии, а какое-то количество, по превышении порога открывать второй коннекшин</blockquote>Не обязательно, если помнишь, что все действия нужно выполнить в одном логическом блоке. Для какого-нибудь RESTful сервиса будет прекрасно работать.<br/>
<br/>
<blockquote>— надо иметь механизм мониторинга коннектов, нужна какая-то статистика подключений<br/>
— надо выставлять лимит в количество подключений — обязательно, иначе постгрес можно легко уложить какой-нибудь один лок</blockquote>Это надо. Реализовать несложно добавив несколько строчек к вышеуказанному коду, и добавив настройки для удобства.<br/>
</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096978" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096986" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-4"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096986" class="tm-comment-thread__indent_l-4"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/tankistua/" title="tankistua" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/181.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/tankistua/" class="tm-user-info__username">
      tankistua
      <!----></a> <a href="#comment_10096986" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T20:57:56.000Z" title="2017-03-01, 23:57">1  мар  2017 в 23:57</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">да много чего можно сделать — просто стоит ли на это тратить время, если есть готовый продукт. Вы же не писали библиотеку обращения к постгресу — а взяли готовую, почему не взять готовое приложение.<br/>
<br/>
Тем более пгбаунсер очень нетяжелая штука, если у него еще конфиги были не в виндовозных .ini-файлах, а в привычных .conf-ах — вообще бы было чудесно</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096986" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097014" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-5"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097014" class="tm-comment-thread__indent_l-5"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Tantrido/" title="Tantrido" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/04a/e83/a13/04ae83a134aa3d47ee970366e68f2859.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Tantrido/" class="tm-user-info__username">
      Tantrido
      <!----></a> <a href="#comment_10097014" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T21:24:30.000Z" title="2017-03-02, 00:24">2  мар  2017 в 00:24</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml"><blockquote>да много чего можно сделать — просто стоит ли на это тратить время, если есть готовый продукт. Вы же не писали библиотеку обращения к постгресу — а взяли готовую, почему не взять готовое приложение.</blockquote>Да потому, что на уровне приложения он не сработает. В многопоточном приложении необходимы раздельные объекты connection и pgBouncer здесь не поможет. Он может разве, что оптимизировать количество процессов postgres — физических подключений. Только libpq об этом ничего знать не будет.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097014" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097400" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-6"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097400" class="tm-comment-thread__indent_l-6"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/tankistua/" title="tankistua" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/181.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/tankistua/" class="tm-user-info__username">
      tankistua
      <!----></a> <a href="#comment_10097400" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T06:56:03.000Z" title="2017-03-02, 09:56">2  мар  2017 в 09:56</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Так с приложением можно делать чего угодно — пгбаунсер работает полностью для него прозрачно, хоть 500 коннекшинов от одного клиента, ему то какая разница. Если написать полностью аналогичный функционал для Вашего пула — то и это позволит уменьшить количество процессов постгреса. Другой вопрос зачем делать пгбаунсер с порезаным функционалом и потом его поддерживать.<br/>
Ну вот не понимаю зачем изобретать велосипед </div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097400" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097488" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-7"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097488" class="tm-comment-thread__indent_l-7"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/sborisov/" title="sborisov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/088.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/sborisov/" class="tm-user-info__username">
      sborisov
      <!----></a> <a href="#comment_10097488" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T07:52:01.000Z" title="2017-03-02, 10:52">2  мар  2017 в 10:52</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Если pgbouncer будет управлять пулом коннектов, а многопоточное приложение к нему подключается к примеру «одним соединением», то мы просто переносим проблему на один уровень выше — потоки в приложении будут ждать, пока один из них отправит данные pgbouncer-у и отдаст соединение. Т.е. придётся создавать такой же пул коннектов к pgbouncer. Предполагаю, что там эта возможность есть, но для моих задач подход описанный в статье оказался достаточным и весьма эффективным.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097488" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097518" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-8"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097518" class="tm-comment-thread__indent_l-8"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/tankistua/" title="tankistua" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/181.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/tankistua/" class="tm-user-info__username">
      tankistua
      <!----></a> <a href="#comment_10097518" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T08:11:03.000Z" title="2017-03-02, 11:11">2  мар  2017 в 11:11</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Это радует, но чем меньше у клиента происходит процессов — тем проще их контролировать.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097518" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097970" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-7"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097970" class="tm-comment-thread__indent_l-7"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Tantrido/" title="Tantrido" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/04a/e83/a13/04ae83a134aa3d47ee970366e68f2859.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Tantrido/" class="tm-user-info__username">
      Tantrido
      <!----></a> <a href="#comment_10097970" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T11:45:30.000Z" title="2017-03-02, 14:45">2  мар  2017 в 14:45</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Потому, что для libpq и pqxx его не изобрели. Напиши многопоточное высоконагруженное приложение на C++ и поймёшь зачем :)</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097970" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097600" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-3"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097600" class="tm-comment-thread__indent_l-3"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Envek/" title="Envek" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/cf9/7ff/df8/cf97ffdf8a1a39e8d0d66fa14dc6d0d8.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Envek/" class="tm-user-info__username">
      Envek
      <!----></a> <a href="#comment_10097600" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T08:36:20.000Z" title="2017-03-02, 11:36">2  мар  2017 в 11:36</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml"><p>Во всех наших проектах мы стараемся делать как можно проще и обычно одно приложение ходит в базу под одним и тем же пользователем, так что все подключения в пуле по факту одинаковые. И когда какой-то поток хочет поработать с базой, он просит в пуле любой свободный коннект или ждёт до 5 секунд, пока таковой освободится, делает, что ему надо с базой и возвращает соединение в пул. Количество соединений в пуле ограничивается эмпирически (в зависимости от того, сколько в процентах времени в среднем код проводит, работая с базой, а сколько — с чем-то другим), но в простых случаях просто ставится равным количеству потоков.</p></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097600" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097426" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097426" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/sborisov/" title="sborisov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/088.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/sborisov/" class="tm-user-info__username">
      sborisov
      <!----></a> <a href="#comment_10097426" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T07:21:24.000Z" title="2017-03-02, 10:21">2  мар  2017 в 10:21</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Хотелось минимизировать зависимости, чтобы всё было в комплекте «из коробки».</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097426" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097514" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-2"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097514" class="tm-comment-thread__indent_l-2"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/tankistua/" title="tankistua" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/181.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/tankistua/" class="tm-user-info__username">
      tankistua
      <!----></a> <a href="#comment_10097514" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T08:08:58.000Z" title="2017-03-02, 11:08">2  мар  2017 в 11:08</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Вот как раз установка пгбаунсера и уменьшает количество проблем, как минимум из-за того, что он себя ведет для всех клиентов одинаково, потому что установлен на сервере, а не на клиенте. Да и его наличие для клиентов полностью прозрачно.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097514" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096720" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096720" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/amakarov/" title="amakarov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/051.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/amakarov/" class="tm-user-info__username">
      amakarov
      <!----></a> <a href="#comment_10096720" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T18:26:12.000Z" title="2017-03-01, 21:26">1  мар  2017 в 21:26</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Еще нужно быть внимательным к выдаче сессий из пула. В любом инициализированном соединении будут временные таблицы, prepared query, переменные типа search_path и т.д. <br/>
Для этого (и для безопасности) pgBouncer создает пулы per user.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096720" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096980" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096980" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Tantrido/" title="Tantrido" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/04a/e83/a13/04ae83a134aa3d47ee970366e68f2859.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Tantrido/" class="tm-user-info__username">
      Tantrido
      <!----></a> <a href="#comment_10096980" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T20:46:43.000Z" title="2017-03-01, 23:46">1  мар  2017 в 23:46</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml">Ну для идеала можно было бы объединить оба подхода: одним pgBouncer в данном случае не обойдёшься. Но сохранение сессии не всегда нужно, а вернее редко.</div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Комментарий пока не оценивали</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Комментарий пока не оценивали" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">0</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096980" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10096722" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-0"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10096722" class="tm-comment-thread__indent_l-0"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/Envek/" title="Envek" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/cf9/7ff/df8/cf97ffdf8a1a39e8d0d66fa14dc6d0d8.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/Envek/" class="tm-user-info__username">
      Envek
      <!----></a> <a href="#comment_10096722" class="tm-comment-thread__comment-link"><time datetime="2017-03-01T18:28:05.000Z" title="2017-03-01, 21:28">1  мар  2017 в 21:28</time> <!----></a></span></span></div> <div class="tm-comment__buttons"><!----> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml"><p>Выложите, пожалуйста, код на GitHub / BitBucket / GitLab.com — гораздо проще и смотреть и компилировать.</p></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+1</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10096722" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <div class="tm-comment-thread__children" style="display:;"><section class="tm-comment-thread"><!----> <article class="tm-comment-thread__comment"><a name="comment_10097416" class="tm-comment-thread__target"></a> <button class="tm-comment-thread__breadcrumbs tm-comment-thread__indent_b_l-1"><div class="tm-comment-thread__circle"></div></button> <!----> <div data-comment-body="10097416" class="tm-comment-thread__indent_l-1"><div data-gallery-root="" class="tm-comment"><header data-comment-header tabindex="-1" class="tm-comment__header"><div class="tm-comment__header-inner"><span class="tm-user-info tm-comment__user-info"><a href="/ru/users/sborisov/" title="sborisov" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="24" src="https://assets.habr.com/habr-web/img/avatars/088.png" width="24" class="tm-entity-image__pic"></img></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/sborisov/" class="tm-user-info__username">
      sborisov
      <!----></a> <a href="#comment_10097416" class="tm-comment-thread__comment-link"><time datetime="2017-03-02T07:12:51.000Z" title="2017-03-02, 10:12">2  мар  2017 в 10:12</time> <svg height="16" width="16" class="tm-svg-img tm-comment-thread__icon-pencil"><title>Комментарий был изменен</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#pencil-small"></use></svg></a></span></span></div> <div class="tm-comment__buttons"><button type="button" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon"><title>Показать предыдущий комментарий</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#small-arrow"></use></svg></button> <!----></div></header> <div class="tm-comment__body-content"><div xmlns="http://www.w3.org/1999/xhtml"><a href="https://github.com/borisovs/pool">Исходный код</a></div></div> <!----> <!----></div> <div class="tm-comment-footer"><div class="tm-votes-meter tm-comment-footer__votes-meter"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-comment"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-rating"></use></svg> <span title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-comment tm-votes-meter__value_rating">+2</span></div> <button type="button" class="tm-comment-thread__button">
                  Ответить
                </button> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-comment-footer__button tm-comment-footer__button_with-icon"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#counter-favorite"></use></svg></span> <!----></button> <button data-comment-popup="10097416" class="tm-comment__button tm-comment__button_with-icon"><svg height="16" width="16" class="tm-svg-img tm-comment__icon tm-comment__icon_dots"><title>Ещё</title> <use xlink:href="/img/megazord-v28.2fb1b1c1..svg#dots"></use></svg></button> <!----></div></div></article> <!----> <!----></section></div> <!----></section></div>  <DIV class="v-portal" style="display:none;"></DIV></div></div> <div class="tm-notice tm-comments__comment-notice tm-notice_positive"><!----> <div class="tm-notice__inner"><!----> <div class="tm-notice__content"><span>Только полноправные пользователи могут оставлять комментарии. <a rel="nofollow" href="/kek/v1/auth/habrahabr/?back=/ru/articles/322966/&hl=ru">Войдите</a>, пожалуйста.</span></div></div></div></div></div></div></div>  <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><div class="tm-tabs tm-tabs"><div><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim">
        Лучшие за сутки
      </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim">
        Похожие
      </button></span></div> <!----></div> <div class="similar-and-daily__tab-view"><div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-article-cards"><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div></div> <!----> <!----> <!----> <!----></div> <!----></div></div> <!----></section> <div><div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-promo"><div class="tm-placeholder-promo__header"><div class="tm-placeholder__line tm-placeholder__line_promo-title"></div></div> <div class="tm-placeholder-promo__body"><div class="tm-placeholder-promo__posts"><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div></div> <div class="tm-placeholder-promo__dots"><div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div></div></div></div> <!----> <!----> <!----> <!----> <!----></div></div> <div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-inset tm-placeholder-tasks"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div> <div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li></ul></div> <div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----></div> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_top"><!----> <div id="adfox_164725680533065327" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-half-page"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section data-navigatable="" tabindex="0" data-async-called="true" class="tm-block tm-stories-block tm-block tm-block_spacing-around"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Истории</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-equal"><div class="tm-stories-empty"><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div></div> <!----></div> <!----></section> <section data-async-called="true" class="tm-block tm-block tm-block_spacing-around"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Работа</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/c_plus_plus_qt_developer" target="_blank" class="tm-vacancies-block__vacancy-title">
        QT разработчик
      </a> <div class="tm-vacancies-block__vacancies-count">
        12
    вакансий
      </div></div><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/programmist_c_plus_plus" target="_blank" class="tm-vacancies-block__vacancy-title">
        Программист C++
      </a> <div class="tm-vacancies-block__vacancies-count">
        123
    вакансии
      </div></div></div> <footer class="tm-block__footer"><a href="https://career.habr.com/catalog" class="tm-block-extralink">
      Все вакансии
    </a></footer></section> <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_bottom"><!----> <div id="adfox_164725691003361602" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-medium-rectangle"></div></div></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Ваш аккаунт
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/articles/322966/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/articles/322966/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Разделы
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Статьи
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Информация
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement/?hl=ru_RU" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/?hl=ru_RU" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Услуги
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">
                Корпоративный блог
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">
                Медийная реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">
                Нативные проекты
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">
                Образовательные программы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">
                Стартапам
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/specials/" class="footer-menu__item-link">
                Спецпроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-vk"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://dzen.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-dzen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"322966":{"id":"322966","timePublished":"2017-03-01T10:30:05+00:00","isCorporative":false,"lang":"ru","titleHtml":"PostgreSQL libpq connection pool","leadData":{"textHtml":"Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании \u003Ca href=\"https:\u002F\u002Fpostgrespro.ru\u002Fdocs\u002Fpostgresql\u002F9.6\u002Flibpq\"\u003EPostgresPRO\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПри написании серверного бекэнда, столкнулся с тем, что в этой библиотеке нет никакого пула коннектов, а работа с БД, предполагалась в довольно интенсивном режиме и одного коннекта было явно мало. Каждый раз устанавливать соединение для отправки полученных данных, было бы просто безумием, т.к. соединение самая долгая операция, решено было написать свой пул коннектов. \u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"114199","alias":"sborisov","fullname":"Sergey Borisov","avatarUrl":null,"speciality":null,"scoreStats":{"score":-18,"votesCount":56},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"donationsMethod":null},"statistics":{"commentsCount":20,"favoritesCount":56,"readingCount":38607,"score":24,"votesCount":26,"votesCountPlus":25,"votesCountMinus":1},"hubs":[{"id":"358","alias":"postgresql","type":"collective","title":"PostgreSQL","titleHtml":"PostgreSQL","isProfiled":true,"relatedData":null},{"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EДля работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании \u003Ca href=\"https:\u002F\u002Fpostgrespro.ru\u002Fdocs\u002Fpostgresql\u002F9.6\u002Flibpq\"\u003EPostgresPRO\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПри написании серверного бекэнда, столкнулся с тем, что в этой библиотеке нет никакого пула коннектов, а работа с БД, предполагалась в довольно интенсивном режиме и одного коннекта было явно мало. Каждый раз устанавливать соединение для отправки полученных данных, было бы просто безумием, т.к. соединение самая долгая операция, решено было написать свой пул коннектов. \u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nИдея в том, что мы при старте программы создаём несколько соединений и храним их в очереди. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКогда приходят данные, мы просто берём свободное соединеие из очереди, а если свободных соединений нет — ждём когда появится, используем его для вставки данных, а затем помещаем соединение обратно. Идея довольна простая, быстро реализуема и самое главное, скорость работы очень высокая. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСоздадим в PostgreSQL базу с именем demo, табличкой demo такой \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Eструктуры\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003E-- Table: public.demo\n\n-- DROP TABLE public.demo;\n\nCREATE TABLE public.demo\n(\n  id integer NOT NULL DEFAULT nextval('demo_id_seq'::regclass),\n  name character varying(256),\n  CONSTRAINT demo_pk PRIMARY KEY (id)\n)\nWITH (\n  OIDS=FALSE\n);\nALTER TABLE public.demo\n  OWNER TO postgres;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nПишем класс который будет представлять собой соединение к БД, параметры соединения, будут прописаны прямо в коде для его упрощения, в реальности конечно их надо хранить в конфигурационном файле и при запуске считывать оттуда, чтобы при изменении парметров сервера, не приходилось перекомпилировать программу. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Epgconnection.h\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E#ifndef PGCONNECTION_H\n#define PGCONNECTION_H\n\n#include &lt;memory\u003E\n#include &lt;mutex\u003E\n#include &lt;libpq-fe.h\u003E\n\nclass PGConnection\n{\npublic:\n    PGConnection();\n    std::shared_ptr&lt;PGconn\u003E connection() const;\n\nprivate:\n    void establish_connection();\n\n    std::string m_dbhost = \"localhost\";\n    int         m_dbport = 5432;\n    std::string m_dbname = \"demo\";\n    std::string m_dbuser = \"postgres\";\n    std::string m_dbpass = \"postgres\";\n\n    std::shared_ptr&lt;PGconn\u003E  m_connection;\n\n};\n\n\n#endif \u002F\u002FPGCONNECTION_H\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Epgconnection.cpp\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E#include \"pgconnection.h\"\nPGConnection::PGConnection()\n{\n    m_connection.reset( PQsetdbLogin(m_dbhost.c_str(), std::to_string(m_dbport).c_str(), nullptr, nullptr, m_dbname.c_str(), m_dbuser.c_str(), m_dbpass.c_str()), &amp;PQfinish );\n\n    if (PQstatus( m_connection.get() ) != CONNECTION_OK &amp;&amp; PQsetnonblocking(m_connection.get(), 1) != 0 )\n    {\n       throw std::runtime_error( PQerrorMessage( m_connection.get() ) );\n    }\n\n}\n\n\nstd::shared_ptr&lt;PGconn\u003E PGConnection::connection() const\n{\n    return m_connection;\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nЧтобы предотвратить возможную утечку ресурсов, соединиение мы будем хранить в умном указателе.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ конструкторе мы вызывам функцию PQsetdbLogin, которая устанавливает соединение к БД, возвращая указатель на соедининие PGconn* и переводим соедининие в асинхронный режим работы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПри завершении работы, соединие должно быть удалено функцией PQfinish, которой передается указатель, возвращённый функцией PQsetdbLogin. Поэтому последним параметром в вызове m_connection.reset() мы передаём адрес функции &amp;PQfinish. Когда умный указатель выйдет из области видимости и счётчик ссылок обнулиться, он вызовет эту функцию, тем самым корректно завершив соединие. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь нам нужен класс, который будет создавать, хранить и управлять работой пула коннектов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Epgbackend.h\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E\n#ifndef PGBACKEND_H\n#define PGBACKEND_H\n\n#include &lt;memory\u003E\n#include &lt;mutex\u003E\n#include &lt;string\u003E\n#include &lt;queue\u003E\n#include &lt;condition_variable\u003E\n#include &lt;libpq-fe.h\u003E\n#include \"pgconnection.h\"\n\n\nclass PGBackend\n{\npublic:\n    PGBackend();\n    std::shared_ptr&lt;PGConnection\u003E connection();\n    void freeConnection(std::shared_ptr&lt;PGConnection\u003E);\n\nprivate:\n    void createPool();\n    \n    std::mutex m_mutex;\n    std::condition_variable m_condition;\n    std::queue&lt;std::shared_ptr&lt;PGConnection\u003E\u003E m_pool;\n\n    const int POOL = 10;\n\n\n};\n\n#endif \u002F\u002FPGBACKEND_H\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Epgbackend.cpp\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E\n#include &lt;iostream\u003E\n#include &lt;thread\u003E\n#include &lt;fstream\u003E\n#include &lt;sstream\u003E\n#include \"pgbackend.h\"\n\nPGBackend::PGBackend()\n{\n\n    createPool();\n  \n}\n\nvoid PGBackend::createPool()\n{\n    std::lock_guard&lt;std::mutex\u003E locker_( m_mutex );\n\n    for ( auto i = 0; i&lt; POOL; ++i ){\n         m_pool.emplace ( std::make_shared&lt;PGConnection\u003E() );\n    }\n}\n\nstd::shared_ptr&lt;PGConnection\u003E PGBackend::connection()\n{\n\n    std::unique_lock&lt;std::mutex\u003E lock_( m_mutex );\n\n    while ( m_pool.empty() ){\n            m_condition.wait( lock_ );\n    }\n\n    auto conn_ = m_pool.front();\n    m_pool.pop();\n\n    return  conn_;\n}\n\n\nvoid PGBackend::freeConnection(std::shared_ptr&lt;PGConnection\u003E conn_)\n{\n    std::unique_lock&lt;std::mutex\u003E lock_( m_mutex );\n    m_pool.push( conn_ );\n    lock_.unlock();\n    m_condition.notify_one();\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nВ функции createPool создаём пул соедининий, я установил 10 соединений. Далее — создаём класс PGBackend, и работаем с ним через функции connection — котороя возвращает свободное соединение к БД, и freeConnection — которая помещяет соединие обратно в очередь. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсё это работает на основе условных переменных, если очередь пуста, значит свободных соединений нет, и поток засыпает, пока не будет разбужен через условную переменную.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПростейший пример, в котором используется наш бекэнд с пулом коннектов, приведён в файле main.cpp. В «боевых условия» у вас конечно будет какой-то цикл событий, при наступлении которых будет проводиться работа с БД. У меня это boost::asio, которая работает асинхронно и принимая события из сети, пишет всё в БД. Приводить здесь её излишне, чтобы не усложнять идею с пулом коннектов. Здесь мы просто создаём 50 потоков, которые работают с сервером через один экземляр PGBackend.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Emain.cpp\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E\n#include &lt;thread\u003E\n#include &lt;iostream\u003E\n#include \"pgbackend.h\"\n\nvoid testConnection(std::shared_ptr&lt;PGBackend\u003E pgbackend)\n{\n\u002F\u002Fполучаем свободное соединение\n    auto conn = pgbackend-\u003Econnection();\n\n    std::string demo = \"SELECT max(id) FROM demo; \" ;\n    PQsendQuery( conn-\u003Econnection().get(), demo.c_str() );\n\n    while ( auto res_ = PQgetResult( conn-\u003Econnection().get()) ) {\n        if (PQresultStatus(res_) == PGRES_TUPLES_OK &amp;&amp; PQntuples(res_)) {\n            auto ID = PQgetvalue (res_ ,0, 0);\n            std::cout&lt;&lt; ID&lt;&lt;std::endl;\n        }\n\n        if (PQresultStatus(res_) == PGRES_FATAL_ERROR){\n            std::cout&lt;&lt; PQresultErrorMessage(res_)&lt;&lt;std::endl;\n        }\n\n        PQclear( res_ );\n    }\n\n\u002F\u002Fвозвращаем соединение в очередь\n    pgbackend-\u003EfreeConnection(conn);\n\n}\n\n\nint main(int argc, char const *argv[])\n{\n\t\n\tauto pgbackend = std::make_shared&lt;PGBackend\u003E();\n\n    \n    std::vector&lt;std::shared_ptr&lt;std::thread\u003E\u003E vec;\n\n    for ( size_t i = 0; i&lt; 50 ; ++i ){\n\n        vec.push_back(std::make_shared&lt;std::thread\u003E(std::thread(testConnection, pgbackend)));\n    }\n\n    for(auto &amp;i : vec) {\n        i.get()-\u003Ejoin();\n    }\n\n \n    return 0;\n}\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nКомпилируется это всё командой:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Eg++ main.cpp pgbackend.cpp pgconnection.cpp -o pool -std=c++14 -I\u002Fusr\u002Finclude\u002Fpostgresql\u002F -lpq -lpthread\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nБудьте внимательны с количеством соединений БД — этот параметр задаётся параметром \u003Ca href=\"https:\u002F\u002Fpostgrespro.ru\u002Fdocs\u002Fpostgrespro\u002F9.6\u002Fruntime-config-connection\"\u003Emax_connections (integer)\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fborisovs\u002Fpool\"\u003EИсходный код\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"C++"},{"titleHtml":"postgresql"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F322966\u002Fcaae7f785891764fe20e5cf747bc4dfd\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F322966\u002Fcaae7f785891764fe20e5cf747bc4dfd\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F322966\\\u002F\"},\"headline\":\"PostgreSQL libpq connection pool\",\"datePublished\":\"2017-03-01T13:30:05+03:00\",\"dateModified\":\"2017-03-02T10:12:28+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Sergey Borisov\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компа...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F322966\\\u002F#post-content-body\",\"about\":[\"h_postgresql\",\"h_cpp\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F322966\\\u002Fcaae7f785891764fe20e5cf747bc4dfd\\\u002F\"]}","metaDescription":"Для работы с PostgreSQL на языке С++, есть замечательная библиотека libpq. Библиотека отлично документирована, есть даже полный перевод на русский язык, от компании PostgresPRO . При написании...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":{"status":true,"reason":null},"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":"tutorial","banner":null,"multiwidget":null,"readingTime":5,"complexity":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"postReasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":["322966"],"viewedPosts":[],"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[{"title":"QT разработчик","vacanciesCount":12,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fc_plus_plus_qt_developer","itemHubs":["qt_software","cpp"]},{"title":"Программист C++","vacanciesCount":123,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fprogrammist_c_plus_plus","itemHubs":["cpp"]}],"hubs":"postgresql,cpp"},"comments":{"articleComments":{"322966":{"refs":{"10096438":{"id":"10096438","parentId":null,"level":0,"timePublished":"2017-03-01T15:35:00+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПочему не pqxx: для С++ логичнее было бы его использовать? На STL думаю проще было бы pool организовать:\u003Cbr\u002F\u003E\r\nhttp:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F12528199\u002Flibpqxx-connection-pool\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОн вроде даже когда-то был в этой библиотеке:\u003Cbr\u002F\u003E\r\nhttp:\u002F\u002Fbazaar.launchpad.net\u002F~jtv\u002Flibpqxx\u002Fconnection-pool\u002Fview\u002Fhead:\u002Fsrc\u002Fconnection_pool.cxx\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cb\u003ECan I have two or more simultaneous transactions?\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003ENot within the same connection. Even if you use nested transactions (see the subtransaction class), a connection is always dealing with just one transaction at a time. Of course you can create a new transaction on the same connection once the previous one has completed.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nIf you want to have multiple concurrent transactions, let them work on different connections. An easy way to do this is to set up a connection pool: create a bunch of lazyconnection objects, all initialized with the same connection string. Connections of this type will set themselves up only when they are actually used, so there is no big cost to creating more than you're going to use. \u003C\u002Fi\u003E\u003C\u002Fblockquote\u003Ehttp:\u002F\u002Fpqxx.org\u002Fdevelopment\u002Flibpqxx\u002Fwiki\u002FFaqFeatures\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"850688","alias":"Tantrido","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F04a\u002Fe83\u002Fa13\u002F04ae83a134aa3d47ee970366e68f2859.jpg","speciality":"Старший программист C++\u002FQt\u002FC#\u002F.Net\u002FNode.js"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10096732"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096718":{"id":"10096718","parentId":null,"level":0,"timePublished":"2017-03-01T18:26:10+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EЧем pgbouncer или pgpool не подошел?\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"110363","alias":"tankistua","fullname":"Vasiliy P. Melnik","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10096850","10097426"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096720":{"id":"10096720","parentId":null,"level":0,"timePublished":"2017-03-01T18:26:12+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЕще нужно быть внимательным к выдаче сессий из пула. В любом инициализированном соединении будут временные таблицы, prepared query, переменные типа search_path и т.д. \u003Cbr\u002F\u003E\r\nДля этого (и для безопасности) pgBouncer создает пулы per user.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"117866","alias":"amakarov","fullname":null,"avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10096980"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096722":{"id":"10096722","parentId":null,"level":0,"timePublished":"2017-03-01T18:28:05+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EВыложите, пожалуйста, код на GitHub \u002F BitBucket \u002F GitLab.com — гораздо проще и смотреть и компилировать.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"41804","alias":"Envek","fullname":"Новиков Андрей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fcf9\u002F7ff\u002Fdf8\u002Fcf97ffdf8a1a39e8d0d66fa14dc6d0d8.jpg","speciality":"Веб-разработчик Злых марсиан: бэкенд и всё вокруг"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10097416"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096732":{"id":"10096732","parentId":"10096438","level":1,"timePublished":"2017-03-01T18:33:54+00:00","timeChanged":"2017-03-01T18:34:47+00:00","isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EОна отстаёт по возможностям. Мне нужен был 9.5 c \u003Ca href=\"https:\u002F\u002Fwiki.postgresql.org\u002Fwiki\u002FWhat's_new_in_PostgreSQL_9.5#INSERT_..._ON_CONFLICT_DO_NOTHING.2FUPDATE_.28.22UPSERT.22.29\"\u003EUPSERT\u003C\u002Fa\u003E, и на тот момент libpqxx не имел этой возможности.\u003Cbr\u002F\u003E\r\nДокументация была гораздо хуже. С libpq работать одно удовольствие, там весьма простой Си с очень хорошими примерами.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EНа STL думаю проще было бы pool организовать\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n А я его на чём реализовал? Что здесь не из STL?\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003Estd::mutex m_mutex;\nstd::condition_variable m_condition;\nstd::queue&lt;std::shared_ptr&lt;PGConnection\u003E\u003E m_pool;\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"114199","alias":"sborisov","fullname":"Sergey Borisov","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10096970"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096850":{"id":"10096850","parentId":"10096718","level":1,"timePublished":"2017-03-01T19:27:00+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EМне казалось, что pgpool и иже — это штуки, ставящиеся возле сервера БД (между сервером и многими клиентами) и не решающие проблем, решаемых в статье (дорогое установление соединения от клиента к удалённому серверу).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВ общем, мне кажется, лучше всегда иметь собственный пул соединений в приложении.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"41804","alias":"Envek","fullname":"Новиков Андрей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fcf9\u002F7ff\u002Fdf8\u002Fcf97ffdf8a1a39e8d0d66fa14dc6d0d8.jpg","speciality":"Веб-разработчик Злых марсиан: бэкенд и всё вокруг"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10096868"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096868":{"id":"10096868","parentId":"10096850","level":2,"timePublished":"2017-03-01T19:34:44+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":1,"votesCount":1,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EДа, лучше — но Вы не можете учесть все ситуации и Вам придется потратить время на разработку и отладку модуля объединения сессий.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСразу говорю я не программер, админ\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа первый взгляд:\u003Cbr\u002F\u003E\r\n — надо объединять в пул не все сессии, а какое-то количество, по превышении порога открывать второй коннекшин\u003Cbr\u002F\u003E\r\n — надо иметь механизм мониторинга коннектов, нужна какая-то статистика подключений\u003Cbr\u002F\u003E\r\n — надо выставлять лимит в количество подключений — обязательно, иначе постгрес можно легко уложить какой-нибудь один лок\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто все есть в пгбаунсере и еще много чего другого\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"110363","alias":"tankistua","fullname":"Vasiliy P. Melnik","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10096978","10097600"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096970":{"id":"10096970","parentId":"10096732","level":2,"timePublished":"2017-03-01T20:36:43+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПростите, недоглядел. Глянул, что С и не увидел дальше. Хорошая у вас реализация и простая. Надо будет себе утянуть. Я бы только добавил ещё map&lt;string, queue\u003E, для группировки пулов по строкам подключения, если полноценный пул делать, когда не знаешь будут ли строки одинаковыми. А для REST-сервиса, при нехватке соединений m_pool.empty() создавал бы новое подключение.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EМне нужен был 9.5 c UPSERT, и на тот момент libpqxx не имел этой возможности.\u003C\u002Fblockquote\u003EА сейчас он там разве есть?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМне pqxx когда-то понравился, что он С++ и работал просто реактивно, по примерам разобрался как работает. Опять же lazy_connection.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"850688","alias":"Tantrido","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F04a\u002Fe83\u002Fa13\u002F04ae83a134aa3d47ee970366e68f2859.jpg","speciality":"Старший программист C++\u002FQt\u002FC#\u002F.Net\u002FNode.js"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096978":{"id":"10096978","parentId":"10096868","level":3,"timePublished":"2017-03-01T20:45:21+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВ C# npgsql всё это есть, жаль, что реализации для С++ нет, в pqxx, например, надо самому делать. Был вариант для версии 2009 года.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E— надо объединять в пул не все сессии, а какое-то количество, по превышении порога открывать второй коннекшин\u003C\u002Fblockquote\u003EНе обязательно, если помнишь, что все действия нужно выполнить в одном логическом блоке. Для какого-нибудь RESTful сервиса будет прекрасно работать.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E— надо иметь механизм мониторинга коннектов, нужна какая-то статистика подключений\u003Cbr\u002F\u003E\r\n— надо выставлять лимит в количество подключений — обязательно, иначе постгрес можно легко уложить какой-нибудь один лок\u003C\u002Fblockquote\u003EЭто надо. Реализовать несложно добавив несколько строчек к вышеуказанному коду, и добавив настройки для удобства.\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"850688","alias":"Tantrido","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F04a\u002Fe83\u002Fa13\u002F04ae83a134aa3d47ee970366e68f2859.jpg","speciality":"Старший программист C++\u002FQt\u002FC#\u002F.Net\u002FNode.js"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10096986"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096980":{"id":"10096980","parentId":"10096720","level":1,"timePublished":"2017-03-01T20:46:43+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНу для идеала можно было бы объединить оба подхода: одним pgBouncer в данном случае не обойдёшься. Но сохранение сессии не всегда нужно, а вернее редко.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"850688","alias":"Tantrido","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F04a\u002Fe83\u002Fa13\u002F04ae83a134aa3d47ee970366e68f2859.jpg","speciality":"Старший программист C++\u002FQt\u002FC#\u002F.Net\u002FNode.js"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10096986":{"id":"10096986","parentId":"10096978","level":4,"timePublished":"2017-03-01T20:57:56+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003Eда много чего можно сделать — просто стоит ли на это тратить время, если есть готовый продукт. Вы же не писали библиотеку обращения к постгресу — а взяли готовую, почему не взять готовое приложение.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТем более пгбаунсер очень нетяжелая штука, если у него еще конфиги были не в виндовозных .ini-файлах, а в привычных .conf-ах — вообще бы было чудесно\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"110363","alias":"tankistua","fullname":"Vasiliy P. Melnik","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10097014"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097014":{"id":"10097014","parentId":"10096986","level":5,"timePublished":"2017-03-01T21:24:30+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cblockquote\u003Eда много чего можно сделать — просто стоит ли на это тратить время, если есть готовый продукт. Вы же не писали библиотеку обращения к постгресу — а взяли готовую, почему не взять готовое приложение.\u003C\u002Fblockquote\u003EДа потому, что на уровне приложения он не сработает. В многопоточном приложении необходимы раздельные объекты connection и pgBouncer здесь не поможет. Он может разве, что оптимизировать количество процессов postgres — физических подключений. Только libpq об этом ничего знать не будет.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"850688","alias":"Tantrido","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F04a\u002Fe83\u002Fa13\u002F04ae83a134aa3d47ee970366e68f2859.jpg","speciality":"Старший программист C++\u002FQt\u002FC#\u002F.Net\u002FNode.js"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10097400"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097400":{"id":"10097400","parentId":"10097014","level":6,"timePublished":"2017-03-02T06:56:03+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EТак с приложением можно делать чего угодно — пгбаунсер работает полностью для него прозрачно, хоть 500 коннекшинов от одного клиента, ему то какая разница. Если написать полностью аналогичный функционал для Вашего пула — то и это позволит уменьшить количество процессов постгреса. Другой вопрос зачем делать пгбаунсер с порезаным функционалом и потом его поддерживать.\u003Cbr\u002F\u003E\r\nНу вот не понимаю зачем изобретать велосипед \u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"110363","alias":"tankistua","fullname":"Vasiliy P. Melnik","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10097488","10097970"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097416":{"id":"10097416","parentId":"10096722","level":1,"timePublished":"2017-03-02T07:12:51+00:00","timeChanged":"2017-03-02T07:13:35+00:00","isSuspended":false,"status":"published","score":2,"votesCount":2,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fborisovs\u002Fpool\"\u003EИсходный код\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"114199","alias":"sborisov","fullname":"Sergey Borisov","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097426":{"id":"10097426","parentId":"10096718","level":1,"timePublished":"2017-03-02T07:21:24+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EХотелось минимизировать зависимости, чтобы всё было в комплекте «из коробки».\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"114199","alias":"sborisov","fullname":"Sergey Borisov","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10097514"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097488":{"id":"10097488","parentId":"10097400","level":7,"timePublished":"2017-03-02T07:52:01+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЕсли pgbouncer будет управлять пулом коннектов, а многопоточное приложение к нему подключается к примеру «одним соединением», то мы просто переносим проблему на один уровень выше — потоки в приложении будут ждать, пока один из них отправит данные pgbouncer-у и отдаст соединение. Т.е. придётся создавать такой же пул коннектов к pgbouncer. Предполагаю, что там эта возможность есть, но для моих задач подход описанный в статье оказался достаточным и весьма эффективным.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"114199","alias":"sborisov","fullname":"Sergey Borisov","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":true,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":["10097518"],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097514":{"id":"10097514","parentId":"10097426","level":2,"timePublished":"2017-03-02T08:08:58+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВот как раз установка пгбаунсера и уменьшает количество проблем, как минимум из-за того, что он себя ведет для всех клиентов одинаково, потому что установлен на сервере, а не на клиенте. Да и его наличие для клиентов полностью прозрачно.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"110363","alias":"tankistua","fullname":"Vasiliy P. Melnik","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097518":{"id":"10097518","parentId":"10097488","level":8,"timePublished":"2017-03-02T08:11:03+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЭто радует, но чем меньше у клиента происходит процессов — тем проще их контролировать.\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"110363","alias":"tankistua","fullname":"Vasiliy P. Melnik","avatarUrl":null,"speciality":null},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097600":{"id":"10097600","parentId":"10096868","level":3,"timePublished":"2017-03-02T08:36:20+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EВо всех наших проектах мы стараемся делать как можно проще и обычно одно приложение ходит в базу под одним и тем же пользователем, так что все подключения в пуле по факту одинаковые. И когда какой-то поток хочет поработать с базой, он просит в пуле любой свободный коннект или ждёт до 5 секунд, пока таковой освободится, делает, что ему надо с базой и возвращает соединение в пул. Количество соединений в пуле ограничивается эмпирически (в зависимости от того, сколько в процентах времени в среднем код проводит, работая с базой, а сколько — с чем-то другим), но в простых случаях просто ставится равным количеству потоков.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"41804","alias":"Envek","fullname":"Новиков Андрей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fcf9\u002F7ff\u002Fdf8\u002Fcf97ffdf8a1a39e8d0d66fa14dc6d0d8.jpg","speciality":"Веб-разработчик Злых марсиан: бэкенд и всё вокруг"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false},"10097970":{"id":"10097970","parentId":"10097400","level":7,"timePublished":"2017-03-02T11:45:30+00:00","timeChanged":null,"isSuspended":false,"status":"published","score":0,"votesCount":0,"message":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПотому, что для libpq и pqxx его не изобрели. Напиши многопоточное высоконагруженное приложение на C++ и поймёшь зачем :)\u003C\u002Fdiv\u003E","editorVersion":1,"author":{"id":"850688","alias":"Tantrido","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F04a\u002Fe83\u002Fa13\u002F04ae83a134aa3d47ee970366e68f2859.jpg","speciality":"Старший программист C++\u002FQt\u002FC#\u002F.Net\u002FNode.js"},"isAuthor":false,"isPostAuthor":false,"isNew":false,"isFavorite":false,"isCanEdit":false,"timeEditAllowedTill":null,"children":[],"vote":{"value":null,"isCanVote":false},"isPinned":false}},"root":["10096438","10096718","10096720","10096722"]}},"articlePinnedComments":{"322966":{"refs":{},"commentIds":[]}},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{"isCanComment":false,"cantCommentReasonKey":"AUTH_REQUIRED","cantCommentReason":"Authorization required","data":null},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":1488455130,"moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"multiwidgets":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"multiwidgetLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"flows":{"updates":{"countNewPostsBySubscription":null,"countNewThreadsBySubscription":null,"countNewNewsBySubscription":null,"countNewPostsAll":46,"countNewNewsAll":27,"countNewThreadsAll":7},"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"welcomePage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"modal":{"modals":[]},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"tasks":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-576","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa86\u002F626\u002F1eb\u002Fa866261eb68eb0fde678c78066d4fd90.png","title":"PG BootCamp Russia 2023","link":"https:\u002F\u002Fu.habr.com\u002FytN90\u002F?erid=4CQwVszH9pUmJwzrcAC"},"title":"Знакомьтесь, слон","lang":"ru","startTime":"2023-09-22T13:51:00+03:00","finishTime":"2023-10-05T23:59:00+03:00","slides":[{"id":"story-576_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa46\u002Fb6a\u002F89f\u002Fa46b6a89f08be7031b01a175dc9d33de.png","button":{"title":"Познакомиться","link":"https:\u002F\u002Fu.habr.com\u002FytN90\u002F?erid=4CQwVszH9pUmJwzrcAC","colorType":"dark"}},{"id":"story-576_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7a9\u002F133\u002F641\u002F7a9133641331b99eeac5d14b1f8eb388.png","button":{"title":"Принять участие","link":"https:\u002F\u002Fu.habr.com\u002FytN90\u002F?erid=4CQwVszH9pUmJwzrcAC","colorType":"light"}},{"id":"story-576_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff9e\u002Fc07\u002F114\u002Ff9ec07114a4cccfffc8df59b7772f95e.png","button":{"title":"Программа","link":"https:\u002F\u002Fu.habr.com\u002FytN90\u002F?erid=4CQwVszH9pUmJwzrcAC","colorType":"light"}},{"id":"story-576_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F96b\u002F965\u002F200\u002F96b965200a7a04714b8431c489f1ac6b.png","button":{"title":"Внести свой вклад","link":"https:\u002F\u002Fu.habr.com\u002FytN90\u002F?erid=4CQwVszH9pUmJwzrcAC","colorType":"dark"}},{"id":"story-576_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdfa\u002Face\u002F63f\u002Fdfaace63f241535359472932b4cac2f9.png","button":{"title":"Влиться в сообщество","link":"https:\u002F\u002Fu.habr.com\u002FytN90\u002F?erid=4CQwVszH9pUmJwzrcAC","colorType":"light"}}]},{"id":"story-572","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa3e\u002F6a7\u002Fe78\u002Fa3e6a7e78ce63ddd9d9c63ab82172127.png","title":"Хабр","link":null},"title":"Полезная подборка о собеседованиях","lang":"ru","startTime":"2023-09-19T11:03:00+03:00","finishTime":"2023-09-26T11:03:58+03:00","slides":[{"id":"story-572_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2e4\u002F33a\u002F558\u002F2e433a558baea53a89c5b537d3a71664.jpg","button":null},{"id":"story-572_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F345\u002F8b0\u002F48e\u002F3458b048e7054e77bce40a3580185c10.jpg","button":{"title":"Шпаргалки","link":"https:\u002F\u002Fu.habr.com\u002Fsobes_01","colorType":"light"}},{"id":"story-572_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F09c\u002F35d\u002F449\u002F09c35d4496eb21c671360470b8890180.jpg","button":{"title":"Классификация","link":"https:\u002F\u002Fu.habr.com\u002Fsobes_02","colorType":"light"}},{"id":"story-572_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F297\u002F7a8\u002F163\u002F2977a8163278618416ade79ff5c6ea2a.jpg","button":{"title":"Как надо и не надо","link":"https:\u002F\u002Fu.habr.com\u002Fsobes_03","colorType":"dark"}},{"id":"story-572_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F904\u002F9d9\u002Fef6\u002F9049d9ef6a1bb9fe045ba5bfce8edbc8.jpg","button":{"title":"Лайфхаки","link":"https:\u002F\u002Fu.habr.com\u002Fsobes_04","colorType":"light"}},{"id":"story-572_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F040\u002F905\u002F11d\u002F04090511dbd4163db7021937a0959cb3.jpg","button":{"title":"Другой взгляд","link":"https:\u002F\u002Fu.habr.com\u002Fsobes_05","colorType":"light"}},{"id":"story-572_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fec1\u002Fdee\u002F2d7\u002Fec1dee2d718c797799a11269c9525bf2.jpg","button":{"title":"22 вопроса","link":"https:\u002F\u002Fu.habr.com\u002Fsobes_06","colorType":"light"}},{"id":"story-572_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F281\u002Fdec\u002F5b6\u002F281dec5b601227d654c95aa3a7c0f6e1.jpg","button":{"title":"Руководство","link":"https:\u002F\u002Fu.habr.com\u002Fsobes_07","colorType":"light"}}]},{"id":"story-570","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1d4\u002F93f\u002F3d6\u002F1d493f3d644d0aa726226075092247b7.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002FgSfLc"},"title":"Разбор резюме дизайнеров","lang":"ru","startTime":"2023-09-18T13:51:00+03:00","finishTime":"2023-09-25T13:51:23+03:00","slides":[{"id":"story-570_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbbe\u002Ffdd\u002F8fb\u002Fbbefdd8fb55293afce73b16655fc8648.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FgSfLc","colorType":"dark"}},{"id":"story-570_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb31\u002Fa17\u002Fef0\u002Fb31a17ef0589e702a78bfff96fb7fd6f.png","button":null},{"id":"story-570_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4e3\u002Fc9a\u002F01e\u002F4e3c9a01e39179e3ded6398463692a29.png","button":{"title":"Смотреть","link":"https:\u002F\u002Fu.habr.com\u002FgSfLc","colorType":"dark"}}]},{"id":"story-564","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7ed\u002F545\u002F30a\u002F7ed54530a1eda71e69f2d8ee514fdbe2.png","title":"Хабр","link":null},"title":"Учиться хорошо","lang":"ru","startTime":"2023-09-11T11:03:00+03:00","finishTime":"2023-09-30T11:03:00+03:00","slides":[{"id":"story-564_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb9f\u002F48d\u002F9a5\u002Fb9f48d9a5b00edc5fc546fdb7ac11b52.jpg","button":null},{"id":"story-564_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa32\u002Fe3c\u002F46b\u002Fa32e3c46bc1ce055623fb552772d62f2.jpg","button":{"title":"Весь список","link":"https:\u002F\u002Fu.habr.com\u002Fst_u401","colorType":"light"}},{"id":"story-564_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F599\u002F4e9\u002F669\u002F5994e9669a88d610b816f7ae643ff100.jpg","button":{"title":"Личный опыт","link":"https:\u002F\u002Fu.habr.com\u002Fst_u402","colorType":"light"}},{"id":"story-564_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F269\u002Ff24\u002F76c\u002F269f2476c9ca409be4e1a9c0345cbcde.jpg","button":{"title":"Мнение","link":"https:\u002F\u002Fu.habr.com\u002Fst_u406","colorType":"light"}},{"id":"story-564_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fafe\u002F87e\u002F596\u002Fafe87e59674cc171e934aa8bcfa0442f.jpg","button":{"title":"Включить нитро","link":"https:\u002F\u002Fu.habr.com\u002Fst_u404","colorType":"light"}},{"id":"story-564_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Faab\u002Fd34\u002F18d\u002Faabd3418da7eaad16d455a3209a807b8.jpg","button":{"title":"Разоблачение","link":"https:\u002F\u002Fu.habr.com\u002Fst_u405","colorType":"light"}},{"id":"story-564_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F276\u002F3ac\u002F5ab\u002F2763ac5ab0e3be3e3e1fee41304f2a96.jpg","button":{"title":"Найти ментора","link":"https:\u002F\u002Fu.habr.com\u002Fst_u403","colorType":"light"}},{"id":"story-564_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc68\u002Fee5\u002F276\u002Fc68ee52767d0ac68ccd3922dd900fc01.jpg","button":{"title":"Гайд по сайту","link":"https:\u002F\u002Fu.habr.com\u002Fst_u407","colorType":"light"}}]},{"id":"story-552","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F310\u002Fb6d\u002F097\u002F310b6d09710575fad755fc8ed317c7ec.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fcalendar_story_2"},"title":"Перевернуть календарь и добавить событие","lang":"ru","startTime":"2023-08-31T10:39:00+03:00","finishTime":"2023-09-30T10:39:00+03:00","slides":[{"id":"story-552_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffd3\u002F1a4\u002F6ab\u002Ffd31a46abecfbc6f654e64a66cb66260.jpg","button":{"title":"Прямо сюда","link":"https:\u002F\u002Fu.habr.com\u002F0RBBA","colorType":"dark"}},{"id":"story-552_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffef\u002F3e3\u002Fb5d\u002Ffef3e3b5d8379c976167169334348272.jpg","button":{"title":"Разместить событие","link":"https:\u002F\u002Fu.habr.com\u002F0RBBA","colorType":"light"}},{"id":"story-552_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8b9\u002Fea9\u002F638\u002F8b9ea9638d36013b31e365ec79b96d2d.jpg","button":{"title":"Тык","link":"https:\u002F\u002Fu.habr.com\u002F0RBBA","colorType":"dark"}}]},{"id":"story-456","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffeb\u002F4ac\u002Fe80\u002Ffeb4ace80a4d66edf300ba9912e8d9e7.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fpromotarif_main"},"title":"Как взлететь к звёздам с «Промо»","lang":"ru","startTime":"2023-07-19T10:42:00+03:00","finishTime":"2023-09-30T23:59:00+03:00","slides":[{"id":"story-456_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe6d\u002F3d3\u002F331\u002Fe6d3d3331288c63df959a620d46ed475.jpg","button":null},{"id":"story-456_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6c7\u002Fb96\u002F7c4\u002F6c7b967c4b875c344b5fb822688da645.jpg","button":null},{"id":"story-456_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F70d\u002Fafd\u002F94c\u002F70dafd94c1dadf8f7b1b04988f841c35.jpg","button":{"title":"Что такое «Промо»","link":"https:\u002F\u002Fu.habr.com\u002Fpromotarif_in","colorType":"light"}},{"id":"story-456_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4aa\u002F184\u002F0d3\u002F4aa1840d3c46d983a64e0d93d2807209.jpg","button":{"title":"Что такое «Промо»","link":"https:\u002F\u002Fu.habr.com\u002Fpromotarif_in","colorType":"light"}},{"id":"story-456_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fea9\u002Fc7f\u002Fe78\u002Fea9c7fe785bbc519e32b2e0e319a39d2.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fpromotarif_in","colorType":"light"}},{"id":"story-456_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fad8\u002F06e\u002Fa40\u002Fad806ea40cdeec78ab6ff06533bb0028.jpg","button":null},{"id":"story-456_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa40\u002Ff50\u002F993\u002Fa40f509932422a1b4325e2d935215770.jpg","button":{"title":"Ключ на старт!","link":"https:\u002F\u002Fu.habr.com\u002Fpromotarif_in","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"notificationsLoading":false,"notificationsList":[],"notificationsPageCount":0,"pendingMarkNotificationsRead":[],"publicationsLoading":true,"publicationsList":[],"publicationsPageCount":0,"pendingDeletePublications":false,"pendingMarkPublicationsRead":false},"events":{"events":[{"id":"events_40","titleHtml":"Неделя аналитиков на Хабр Карьере","startDay":"2023-09-18","finishDay":"2023-09-24","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fte\u002F28\u002Fdo\u002Fte28doaa_hyyc_pmkmwg13zfmss.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Ff5E45","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EЗапускаем вторую Неделю аналитиков в&#160;этом году. Приходите искать работу или, как минимум, проводить время с&#160;пользой. \u003C\u002Fp\u003E\u003Cp\u003EКак все устроено: компании рассказывают о&#160;себе в&#160;формате коротких видеопитчей и&#160;делятся открытыми вакансиями в&#160;аналитике, а&#160;участники недели смотрят эти питчи, голосуют за&#160;лучший, нажимая на&#160;кнопку &#171;Хочу тут работать&#187;, и&#160;откликаются на&#160;понравившиеся вакансии. В&#160;течение недели встречаемся на&#160;IT-митапах, обсуждаем проекты, технологии, тренды и&#160;отвечаем на&#160;ваши вопросы.\u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EРегистрируйтесь, чтобы ничего не&#160;пропустить! И&#160;следите за&#160;письмами&#160;&#8212; на&#160;старте Недели мы&#160;пришлем кодовую фразу для откликов на&#160;вакансии (с&#160;ней ребята из&#160;компаний пообещали отвечать быстрее).\u003C\u002Fp\u003E\u003Cbr \u002F\u003E"},{"id":"event_35","titleHtml":"Yandex Scale","startDay":"2023-09-25","finishDay":"2023-09-26","startTime":"17:00","finishTime":"18:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fbc\u002Fcf\u002F14\u002Fbccf14abdqnwotholdoyyhti01e.png","eventUrl":"https:\u002F\u002Fclck.ru\u002F35a2kx","geo":["Москва"],"isOnline":true,"descriptionHtml":"\u003Cp\u003E25-26 сентября пройдет главная конференция об&nbsp;облачных технологиях и&nbsp;бизнесе в&nbsp;России Yandex Scale. Вас ждут два дня докладов и&nbsp;обсуждений, 6&nbsp;тематических треков: Data Platform, ML, Serverless, Digital Workplace, Security, Infra + K8s и&nbsp;30&nbsp;крутых спикеров.\u003C\u002Fp\u003E\u003Cp\u003EВ&nbsp;первый день поговорим о&nbsp;новостях платформы и&nbsp;наших клиентов, во&nbsp;второй&nbsp;&mdash; вместе с&nbsp;партнерами представим крутые кейсы и&nbsp;расскажем обо всем, что нужно знать об&nbsp;облаках и&nbsp;облачных сервисах. Инструменты для работы с&nbsp;данными, речевая аналитика, машинное обучение в&nbsp;облаке, OpenSource, новости YandexGPT, кейсы от&nbsp;Skyeng, Whoosh, Азбуки вкуса и&nbsp;других крупных игроков&nbsp;&mdash; все это лишь малая часть насыщенной программы Yandex Scale.\u003C\u002Fp\u003E\u003Cp\u003EУчастие в&nbsp;конференции бесплатное. Для этого необходимо зарегистрироваться на&nbsp;сайте.\u003C\u002Fp\u003E"},{"id":"events_46","titleHtml":"Битва пет-проектов","startDay":"2023-09-25","finishDay":"2023-11-30","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fq4\u002Fbl\u002Ftl\u002Fq4bltl5nykwetj_aaaauhdaow6u.png","eventUrl":"https:\u002F\u002Fpet-project.habr.com\u002F?utm_source=special&utm_medium=calendar&utm_campaign=pet_project","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EСобрали две команды стажеров и&#160;джунов, которые будут работать над пет-проектами под кураторством опытных менторов. А&#160;определять победителей, которые получат стажировку в&#160;компании, будете&#160;вы.\u003C\u002Fp\u003E\u003Cp\u003EВнутри много движухи для зрителей: воркшопы по&#160;разработке, разборы резюме, публичные собеседования, Q&#38;A-сессии и&#160;даже чат, где можно найти себе команду и&#160;запилить какой-нибудь крутой пет-проект. \u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЕсть отличный бонус для начинающих: будем собирать стажировки и&#160;джуновские вакансии с&#160;рынка для еженедельной рассылки в&#160;рамках битвы. \u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EРегистрируйтесь, чтобы ничего не&#160;пропустить!\u003C\u002Fp\u003E\u003Cbr \u002F\u003E"},{"id":"event_16","titleHtml":"Тестирование алгоритмов систем помощи водителю","startDay":"2023-09-28","finishDay":"2023-09-28","startTime":"10:00","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fdp\u002Frg\u002F0o\u002Fdprg0oqjoduu6x0s0skjszojzsy.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fexpcalendar","geo":["Москва"],"isOnline":false,"descriptionHtml":"\u003Cp\u003EНа&nbsp;семинаре будет показан подход к&nbsp;тестированию алгоритмов систем помощи водителю, позволяющий значительно сократить количество натурных испытаний за&nbsp;счет использования виртуального полигона.\u003C\u002Fp\u003E\u003Cp\u003EТестирование будет рассмотрено на&nbsp;примере системы удержания в&nbsp;полосе с&nbsp;функцией адаптивного круиз-контроля и&nbsp;будет включать в&nbsp;себя тестирование алгоритмов в&nbsp;реальном времени на&nbsp;комплексах полунатурного моделирования &laquo;РИТМ&raquo; с&nbsp;использованием CAN-интерфейсов.\u003C\u002Fp\u003E\u003Cp\u003EТакже мы&nbsp;продемонстрируем процесс создания математической модели динамики движения автомобиля и&nbsp;виртуального полигона, необходимых для тестирования разработанных алгоритмов.\u003C\u002Fp\u003E\u003Cp\u003EМероприятие призвано собрать на&nbsp;одной площадке всех специалистов данной тематики для обмена знаний и&nbsp;опыта, чтобы вооружившись последними технологиями дать толчок в&nbsp;развитии безопасности дорожного движения.\u003C\u002Fp\u003E"},{"id":"event_18","titleHtml":"Business&IT Day: Retail CPG","startDay":"2023-09-28","finishDay":"2023-09-28","startTime":"09:50","finishTime":"14:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fsi\u002Fu_\u002F80\u002Fsiu_80howp0giy-wsvmnrb1qrnw.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fbusinessitday","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EЕжегодная онлайн-конференция про организацию бизнес-процессов и&nbsp;использование информационных технологий в&nbsp;ритейле и&nbsp;ТНП.\u003C\u002Fp\u003E\u003Cp\u003EОбсудим IT&nbsp;в&nbsp;розничной торговле, федеральных и&nbsp;региональных розничных сетях, сетях аптек и&nbsp;на&nbsp;предприятиях, производящих товары народного потребления.\u003C\u002Fp\u003E"},{"id":"events_43","titleHtml":"ТЕХНОКРАТИЯ: Первая IT-конференция «без купюр»","startDay":"2023-09-28","finishDay":"2023-09-28","startTime":"10:30","finishTime":"20:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fx5\u002Fi3\u002Fto\u002Fx5i3tot8iivh5vpg-ia9e6qmmlu.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_thkrt","geo":["Москва"],"isOnline":false,"descriptionHtml":"\u003Cp\u003E28&nbsp;сентября АЭРОДИСК будет проводить оффлайн-конференцию для технических специалистов, которые непосредственно работают с&nbsp;российским оборудованием.\u003C\u002Fp\u003E\u003Cp\u003EБудет много практических докладов о&nbsp;том, как максимально эффективно использовать существующий функционал продуктов АЭРОДИСК, о&nbsp;том, как мы&nbsp;строим наши процессы разработки в&nbsp;привязке к&nbsp;запросам заказчиков. Также немного поговорим о&nbsp;будущем технологий в&nbsp;России, проведем практические воркшопы.\u003C\u002Fp\u003E\u003Cp\u003EКроме того, мы&nbsp;ожидаем гостей&nbsp;&mdash; других российских производителей&nbsp;&mdash; с&nbsp;их&nbsp;практическими докладами.\u003C\u002Fp\u003E"},{"id":"events_48","titleHtml":"Вебинар «BI в мессенджере для менеджеров продаж: кейс ГК Самолет»","startDay":"2023-09-28","finishDay":"2023-09-28","startTime":"11:00","finishTime":"12:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fel\u002Fii\u002Fax\u002Feliiaxns5wtik00rgysxt5qeb-i.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_sssb","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EКак сделать бизнес-аналитику доступной каждому сотруднику, даже если он&#160;работает &#171;в&#160;полях&#187; или у&#160;него нет времени разбираться со&#160;сложным интерфейсом? Это возможно!\u003C\u002Fp\u003E\u003Cp\u003EНа&#160;вебинаре расскажем, как&#160;AI позволяет получать аналитические данные прямо в&#160;мессенджер за&#160;доли секунды.\u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EСодержание вебинара:\u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E1. Easy Report: BI&#160;в&#160;мессенджере. Обзор системы и&#160;кейсы применения. \u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E2. Быстрый доступ к&#160;данным для коммерческого блока через&#160;BI в&#160;мессенджере: кейс ГК&#160;Самолет. \u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E3. Демонстрация работы решения.\u003C\u002Fp\u003E\u003Cbr \u002F\u003E"},{"id":"event_14","titleHtml":"XIX конференция разработчиков свободных программ «Базальт СПО»","startDay":"2023-09-29","finishDay":"2023-10-01","startTime":"10:00","finishTime":"19:00","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fyi\u002Fh2\u002Fmk\u002Fyih2mkst3jow_svnkemhq27h0o4.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_bzlt","geo":["Переславль-Залесский"],"isOnline":true,"descriptionHtml":"\u003Cp\u003EЕжегодно конференция объединяет разработчиков свободных программ из&nbsp;России и&nbsp;других стран, чтобы обсудить новейшие достижения в&nbsp;области свободного&nbsp;ПО и&nbsp;перспективы его развития, наладить личные и&nbsp;профессиональные контакты, инициировать создание новых проектов сферы СПО.\u003C\u002Fp\u003E\u003Cp\u003EДля участия в&nbsp;конференции в&nbsp;качестве докладчика необходимо отправить заявку по&nbsp;адресу conference@lists.altlinux.org до&nbsp;1&nbsp;сентября 2023&nbsp;года.\u003C\u002Fp\u003E"},{"id":"event_29","titleHtml":"Kokoc Hackathon","startDay":"2023-09-29","finishDay":"2023-10-01","startTime":"19:00","finishTime":"21:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fuq\u002Frt\u002Frd\u002Fuqrtrd0fibci9i7phuuybk8drog.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_kks","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EС&nbsp;29&nbsp;сентября по&nbsp;1&nbsp;октября участвуйте в&nbsp;хакатоне Kokoc Hackathon 2023&nbsp;с призовым фондом 1&nbsp;000&nbsp;000&nbsp;рублей. \nНа&nbsp;хакатон приглашаются фронтенд-, бэкенд-, мобильные разработчики, аналитики, графические и&nbsp;UX\u002FUI-дизайнеры, продакт-менеджеры, маркетологи. Участвовать можно индивидуально или в&nbsp;команде до&nbsp;5&nbsp;человек.\u003C\u002Fp\u003E\u003Cp\u003EТреки хакатона:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003EРазработка решения для определения тематики веб-ресурса\u003C\u002Fli\u003E\u003Cli\u003EСоздание корпоративного веб-приложения, которое конвертирует физическую активность в&nbsp;благотворительные пожертвования\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EТаймлайн Kokoc Hackathon 2023:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003EДо&nbsp;27&nbsp;сентября открыта регистрация на&nbsp;хакатон;\u003C\u002Fli\u003E\u003Cli\u003EС&nbsp;29&nbsp;сентября по&nbsp;1&nbsp;октября пройдёт основной этап хакатона: создание решений, чекпоинты с&nbsp;экспертами;\u003C\u002Fli\u003E\u003Cli\u003E1&nbsp;октября&nbsp;&mdash; финальный день хакатона и&nbsp;награждение победителей.\u003C\u002Fli\u003E\u003C\u002Ful\u003E"},{"id":"events_42","titleHtml":"Ruby Russia 2023 Online","startDay":"2023-09-30","finishDay":"2023-09-30","startTime":"11:00","finishTime":"21:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fts\u002F0o\u002Foj\u002Fts0oojrjposx193k5kf9y4vh5qu.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_rbrs","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EОдин день, 14&nbsp;новейших докладов, доклады в&nbsp;высоком качестве&nbsp;&mdash; всё это RubyRussia&rsquo;23. В&nbsp;конце сентября мы&nbsp;соберём рубистов со&nbsp;всей России и&nbsp;ближнего зарубежья, чтобы с&nbsp;ведущими разработчиками обсудить будущее нашего любимого языка и&nbsp;всего, что построено вокруг него.\u003C\u002Fp\u003E"},{"id":"event_21","titleHtml":"Видео+Конференция-2023 — главное событие о технологиях ВКС и совместной работе","startDay":"2023-10-05","finishDay":"2023-10-05","startTime":"10:00","finishTime":"19:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fcc\u002Fh9\u002F2p\u002Fcch92p_kfj0mbxeokbdgp-uopbw.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_vcs","geo":["Москва"],"isOnline":false,"descriptionHtml":"\u003Cp\u003EПриглашаем 5&nbsp;октября в&nbsp;Soluxe Hotel Moscow на&nbsp;главное отечественное мероприятие о&nbsp;технологиях видеоконференцсвязи, корпоративном общении и&nbsp;совместной работе. &laquo;Видео+Конференция&raquo; берёт своё начало в&nbsp;2011-ом году. Каждый год мероприятие объединяет более 500&nbsp;участников: ИТ-руководителей и&nbsp;профессионалов, отвечающих за&nbsp;цифровизацию коммуникаций и&nbsp;совместной работы, внедрение и&nbsp;эксплуатацию систем ВКС, мессенджеров и&nbsp;других ИТ-решений в&nbsp;российских частных и&nbsp;государственных компаниях.\u003Cbr\u003E&laquo;В+К-2023&raquo;&nbsp;&mdash; это:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003Eвсё о российских технологиях для замены иностранных сервисов ВКС и мессенджеров\u003C\u002Fli\u003E\u003Cli\u003Eвыступления лидеров мнений отечественной ИТ-сферы\u003C\u002Fli\u003E\u003Cli\u003Eоткрытый диалог с разработчиками коммуникационного ПО\u003C\u002Fli\u003E\u003Cli\u003Eбольшая демозона с новыми решениями для совместной работы, устройствами для рабочих мест и автоматизации переговорных комнат\u003C\u002Fli\u003E\u003Cli\u003Eтехнологическая интеграция между популярными ИТ-решениями\u003C\u002Fli\u003E\u003Cli\u003Eнетворкинг\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EПрограмма формируется.\u003Cbr\u003EУчастие бесплатное, онлайн-регистрация обязательна, количество мест ограничено.\u003C\u002Fp\u003E"},{"id":"events_37","titleHtml":"PG Boot Camp Russia 2023","startDay":"2023-10-05","finishDay":"2023-10-05","startTime":"10:00","finishTime":"17:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Ft_\u002Faf\u002Fcx\u002Ft_afcxlpq7bfbhcuziffrlpoddw.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002FytN90","geo":["Москва"],"isOnline":true,"descriptionHtml":"\u003Cp\u003EPG&nbsp;Boot Camp Russia 2023&nbsp;&mdash; мероприятие, направленное на&nbsp;приобретение практических навыков при работе с&nbsp;СУБД PostgreSQL. Программа рассчитана как на&nbsp;начинающих специалистов, так и&nbsp;на&nbsp;опытных разработчиков, желающих углубить свои знания ядра и&nbsp;экосистемы PostgreSQL и&nbsp;применить их&nbsp;на&nbsp;практике.\u003C\u002Fp\u003E\u003Cp\u003EПлощадка позволит участникам получить актуальную информацию по&nbsp;внедрению СУБД PostgreSQL в&nbsp;ИТ-инфраструктуру организаций и&nbsp;эффективному ее&nbsp;использованию, а&nbsp;также принять участие в&nbsp;практических мастер-классах от&nbsp;ведущих экспертов в&nbsp;своей области.\u003C\u002Fp\u003E"},{"id":"events_44","titleHtml":"Хабрасеминар «Как построить IT-бренд на Хабре»","startDay":"2023-10-06","finishDay":"2023-10-06","startTime":"11:00","finishTime":"15:00","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fxz\u002Fld\u002F4_\u002Fxzld4_xafntu0fwkzn66itfxrl8.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_hbrsm6","geo":["Москва"],"isOnline":false,"descriptionHtml":"\u003Cp\u003EСильный IT-бренд&nbsp;&mdash; один из&nbsp;важных драйверов развития любой компании. Его построение&nbsp;&mdash; многоплановый процесс, составной частью которого является прямая коммуникация с&nbsp;IT-сообществом. Но&nbsp;как выстроить такую коммуникацию и&nbsp;как сделать ее&nbsp;эффективной? В&nbsp;этом может помочь Хабр.\u003C\u002Fp\u003E\u003Cp\u003E6&nbsp;октября мы&nbsp;выходим в&nbsp;офлайн, чтобы обсудить практики работы с&nbsp;IT-брендом. На&nbsp;хабрасеминаре, который пройдёт в&nbsp;Gray Green Event Space по&nbsp;адресу: 3-й Красносельский пер., 19, стр&nbsp;13, мы&nbsp;с&nbsp;экспертами компаний разберём, что даёт сильный IT-бренд и&nbsp;как его можно развивать на&nbsp;Хабре.\u003C\u002Fp\u003E\u003Cp\u003EВ&nbsp;программе мероприятия: \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003EАндрей Шершов (РСХБ)&nbsp;&mdash; об&nbsp;опыте ведения блога на&nbsp;Хабре\u003C\u002Fli\u003E\u003Cli\u003EАлександр Рындин (Хабр)&nbsp;&mdash; о&nbsp;новых услугах Хабра для решения бизнес-задач компаний\u003C\u002Fli\u003E\u003Cli\u003EКруглый стол: &laquo;Как построить сильный IT-бренд и&nbsp;при чем тут Хабр&raquo;\u003C\u002Fli\u003E\u003C\u002Ful\u003E"},{"id":"events_45","titleHtml":"Joker","startDay":"2023-10-09","finishDay":"2023-10-14","startTime":"16:00","finishTime":"19:30","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fxo\u002Fvw\u002Fd6\u002Fxovwd6picvqcupuizlayrlxiqcq.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_jkr","geo":["Санкт-Петербург"],"isOnline":true,"descriptionHtml":"\u003Cp\u003EБольшая Java-конференция. 9&#8211;10 октября&#160;&#8212; онлайн часть, 13&#8211;14 октября&#160;&#8212; часть в&#160;Санкт-Петербурге с&#160;возможностью удалённого подключения.\u003C\u002Fp\u003E\u003Cp\u003EВ&#160;программе, как обычно, полезная Java-разработчикам техническая конкретика: инструменты, фреймворки, JVM, языковые нововведения и&#160;не&#160;только.\u003C\u002Fp\u003E\u003Cbr \u002F\u003E"},{"id":"events_41","titleHtml":"Deep cloud dive. Первая дискуссионная конференция beeline cloud","startDay":"2023-10-12","finishDay":"2023-10-12","startTime":"11:00","finishTime":"14:10","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fsk\u002Fem\u002Fiu\u002Fskemiuqjpev6azkn-imzs2lxasi.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_blndcd","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EНа&nbsp;одной площадке встретятся эксперты ведущих компаний рынка, чтобы обсудить тренды, затронуть наболевшие проблемы и&nbsp;наметить пути их&nbsp;решения.\u003C\u002Fp\u003E\u003Cp\u003EТри дискуссионных блока:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003ECloud. Локализация рынка облаков, проблематика отечественных продуктов&nbsp;&mdash; что нас ждет дальше?\u003C\u002Fli\u003E\u003Cli\u003EData. Демократизация ИИ&nbsp;и&nbsp;больших данных: примеры внедрений, перспективы развития\u003C\u002Fli\u003E\u003Cli\u003ESecurity. Кибербезопасность: актуальные угрозы, прогнозы и&nbsp;ожидания на&nbsp;2024 год\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EПрограмма мероприятия:\u003Cbr\u003E11:00&nbsp;&mdash; 11:10 Открытие конференции\u003Cbr\u003E11:10&nbsp;&mdash; 12:00 Локализация в&nbsp;сфере Cloud: миграция в&nbsp;российское облако\u003Cbr\u003E12:50&nbsp;&mdash; 13:20 Большие данные и&nbsp;искусственный интеллект: перспективы развития\u003Cbr\u003E13:20&nbsp;&mdash; 14:10&nbsp;Кибербезопасность, ИТ-аутсорсинг: что нас ждет в&nbsp;2024 году\u003C\u002Fp\u003E\u003Cp\u003EДля кого:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003ECTO и&nbsp;руководители бизнеса\u003C\u002Fli\u003E\u003Cli\u003EИТ- и&nbsp;ИБ-директора, топ-менеджеры\u003C\u002Fli\u003E\u003Cli\u003EАрхитекторы, профильные ИТ-специалисты\u003C\u002Fli\u003E\u003Cli\u003EАналитики данных, дата-инженеры\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EНе&nbsp;пропустите интерактивный диалог о&nbsp;рынке ИТ. Мероприятие бесплатное.\u003C\u002Fp\u003E\u003Cp\u003EРегистрируйтесь и&nbsp;мы&nbsp;пришлем вам ссылку на&nbsp;онлайн-трансляцию.\u003C\u002Fp\u003E"},{"id":"event_34","titleHtml":"Курс «Архитектура программного обеспечения» от Яндекс Практикума","startDay":"2023-10-16","finishDay":"2023-10-16","startTime":"09:00","finishTime":"23:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fjw\u002Fiy\u002Fj2\u002Fjwiyj2kplvp4rn8uiog74md1xes.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_yprarch","geo":[],"isOnline":true,"descriptionHtml":"\u003Cp\u003EКурс для опытных разработчиков уровня Middle и&nbsp;Senior, которые хотят научиться создавать с&nbsp;нуля архитектуру сервисов и&nbsp;приложений. Вас ждет много практических заданий, прокачка насмотренности в&nbsp;области архитектуры&nbsp;ПО и&nbsp;экспертиза от&nbsp;техлидов Яндекса и&nbsp;других технологических компаний.\u003C\u002Fp\u003E\u003Cp\u003EЧему вы научитесь:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003Eопределять, какую архитектуру приложения применять&nbsp;&mdash; монолитную или микросервисную;\u003C\u002Fli\u003E\u003Cli\u003Eвыбирать тип хранения данных, формат и&nbsp;протокол обмена данными&nbsp;&mdash; в&nbsp;зависимости от&nbsp;типа вашего приложения;\u003C\u002Fli\u003E\u003Cli\u003Eразбираться в&nbsp;вертикальном и&nbsp;горизонтальном масштабировании, балансировке нагрузки и&nbsp;стратегиях кеширования.\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EГлавное про курс:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003Eвозможность повысить свой грейд, а&nbsp;соответственно&nbsp;&mdash; ценность на&nbsp;рынке;\u003C\u002Fli\u003E\u003Cli\u003E+5&nbsp;новых архитектур в&nbsp;портфолио;\u003C\u002Fli\u003E\u003Cli\u003Eнаставничество и&nbsp;код-ревью от&nbsp;экспертов с&nbsp;большим опытом проектирования архитектуры;\u003C\u002Fli\u003E\u003Cli\u003Eпрограмма длительностью 6&nbsp;месяцев: учёбе нужно уделять от&nbsp;15&nbsp;часов в&nbsp;неделю;\u003C\u002Fli\u003E\u003Cli\u003Eподойдёт для разработчиков с&nbsp;опытом коммерческой бэкенд-разработки от&nbsp;2&nbsp;лет.\u003C\u002Fli\u003E\u003C\u002Ful\u003E"},{"id":"events_47","titleHtml":"Семинар «Engee – российская платформа для разработки сложных технических систем»","startDay":"2023-10-18","finishDay":"2023-10-18","startTime":"10:00","finishTime":"15:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fax\u002Fek\u002Fha\u002Faxekhakoitd28x3e-yf5xg96nlc.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_xpn","geo":["Москва"],"isOnline":false,"descriptionHtml":"\u003Cp\u003EEngee&#160;&#8212; самая новая платформа на&#160;российском рынке, предназначенная для разработки сложных технических систем. Она позволяет инженерам и&#160;конструкторам предприятий наукоемкой отрасли создавать качественные и&#160;эффективные продукты в&#160;высокотехнологичном программном окружении.\u003C\u002Fp\u003E\u003Cp\u003EНа&#160;семинаре технические специалисты ЦИТМ Экспонента проведут подробную демонстрацию возможностей нашей среды. Вы&#160;увидите актуальные промышленные возможности использования платформы, узнаете, как работать с&#160;интерактивными скриптами и&#160;с&#160;графическими инструментами для построения динамических моделей.\u003C\u002Fp\u003E\u003Cp xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНаш семинар будет полезен специалистам, решающим широкий спектр задач, затрагивающих в&#160;своей работе машинное обучение, оптимизацию и&#160;искусственный интеллект, ТАУ, цифровую обработку сигналов, радиосвязь и&#160;многое другое\u003C\u002Fp\u003E\u003Cbr \u002F\u003E"},{"id":"event_31","titleHtml":"Russia Risk Conference 2023 — 19-я конференция по риск-менеджменту","startDay":"2023-10-25","finishDay":"2023-10-26","startTime":"10:00","finishTime":"19:00","imageUrl":"https:\u002F\u002Fhsto.org\u002Fwebt\u002Fhz\u002Ftg\u002F9k\u002Fhztg9k1w_eanhcx-7f184wdouri.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_rskcnf","geo":["Москва"],"isOnline":true,"descriptionHtml":"\u003Cp\u003E25&ndash;26 октября состоится Russia Risk Conference 2023&nbsp;&mdash; ключевая конференция по&nbsp;управлению рисками в&nbsp;финансовой сфере.\u003C\u002Fp\u003E\u003Cp\u003EПрограмма конференции включает темы:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003EТехнологии искусственного интеллекта в&nbsp;управлении рисками: LLM, применение&nbsp;ML, управление модельным риском, Reject Inference, Muti-head graph attention-сети, Reinforcement Learning\u003C\u002Fli\u003E\u003Cli\u003EОбсуждение макроэкономических трендов, кредитно-денежной и&nbsp;регуляторной политики. Прогнозирование тенденций риска\u003C\u002Fli\u003E\u003Cli\u003EКредитные риски: тенденции в&nbsp;управлении кредитными рисками в&nbsp;новых условиях. Моделирование отклика клиента на&nbsp;действия кредитора. Оптимизация стратегий кредитования\u003C\u002Fli\u003E\u003Cli\u003EКомплексное управление рисками. Блиц-интервью с&nbsp;директорами по&nbsp;рискам страховых, лизинговых, микрофинансовых и&nbsp;других компаний&nbsp;&mdash; представителей финансового сектора\u003C\u002Fli\u003E\u003Cli\u003EОперационные риски и&nbsp;кибербезопасность\u003C\u002Fli\u003E\u003Cli\u003EЦифровые финансовые активы (ЦФА): риски и&nbsp;возможности цифрового рубля\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EДля кого: CRO, топ-менеджеров, курирующих управление рисками, специалистов по&nbsp;мониторингу и&nbsp;валидации рисков, риск-менеджеров и&nbsp;риск-аналитиков, data scientists, экспертов-практиков в&nbsp;области управления кредитными, рыночными и&nbsp;операционными рисками, специалистов управлений количественного анализа и&nbsp;моделирования рисков.\u003C\u002Fp\u003E"}]}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.f2cd882e.js" defer></script><script src="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.4441b282.js" defer></script>



    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S28W1WC23F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
